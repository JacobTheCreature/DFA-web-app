<div class="p-4">
  <h2 class="mb-4">DFA Transition Table</h2>
  <div class="mb-3">
    <label class="form-label fw-bold">Input Alphabet:</label>
    <div class="d-flex gap-3">
      <div class="form-check">
        <input 
          class="form-check-input" 
          type="radio" 
          value="ab"
          [(ngModel)]="alphabet"
          (ngModelChange)="onAlphabetChange()"
        >
        <label class="form-check-label" for="alphabetAB">
          a, b
        </label>
      </div>
      <div class="form-check">
        <input
          class="form-check-input"
          type="radio"
          value="01"
          [(ngModel)]="alphabet"
          (ngModelChange)="onAlphabetChange()"
        >
        <label class="form-check-label" for="alphabet01">
          0, 1
        </label>
      </div>
    </div>
  </div>
  
  <div class="d-flex gap-2 mb-3">
    <button (click)="addState()" class="btn btn-primary">Add State</button>
    <button (click)="clearAll()" class="btn btn-danger">Clear All</button>
  </div>

  <div class="table-responsive mb-3">
    <table class="table table-hover table-bordered">
      <thead class="table-light">
        <tr class="text-center">
          <th>State Name</th>
          <th>Start State</th>
          <th>Accepting</th>
          <th>Transition on '{{ getSymbol1() }}'</th>
          <th>Transition on '{{ getSymbol2() }}'</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let state of states; let i = index">
          <td>
            <input 
              type="text" 
              [(ngModel)]="state.name"
              (ngModelChange)="onInputChange()"
              placeholder="State name"
              class="form-control form-control-sm"
            />
          </td>
          <td class="text-center align-middle">
            <input 
              type="radio" 
              name="startState"
              [value]="state.name"
              [(ngModel)]="startStateName"
              (ngModelChange)="onInputChange()"
              class="form-check-input"
            />
          </td>
          <td class="text-center align-middle">
            <input 
              type="checkbox" 
              [(ngModel)]="state.isAccepting"
              (ngModelChange)="onInputChange()"
              class="form-check-input"
            />
          </td>
          <td>
            <select 
              [(ngModel)]="state.transitionA"
              (ngModelChange)="onInputChange()"
              class="form-select form-select-sm"
            >
              <option value="">-- Select --</option>
              <option value="DEAD">Dead State</option>
              <option *ngFor="let stateName of getStateNames()" [value]="stateName">
                {{ stateName }}
              </option>
            </select>
          </td>
          <td>
            <select 
              [(ngModel)]="state.transitionB"
              (ngModelChange)="onInputChange()"
              class="form-select form-select-sm"
            >
              <option value="">-- Select --</option>
              <option value="DEAD">Dead State</option>
              <option *ngFor="let stateName of getStateNames()" [value]="stateName">
                {{ stateName }}
              </option>
            </select>
          </td>
          <td class="text-center align-middle">
            <button 
              (click)="removeState(i)" 
              class="btn btn-danger btn-sm"
              [disabled]="states.length <= 1"
            >
              <i class="bi bi-x-lg"></i>
            </button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="alert" [ngClass]="validationResult.isValid ? 'alert-success' : 'alert-danger'">
    <div *ngIf="validationResult.isValid">
      <strong>Valid DFA</strong>
    </div>
    <div *ngIf="!validationResult.isValid">
      <p class="mb-2"><strong>The given data can't be used to create a DFA</strong></p>
      <ul class="mb-0">
        <li *ngFor="let error of validationResult.errors">{{ error }}</li>
      </ul>
    </div>
  </div>

  <div class="mt-4" *ngIf="validationResult.isValid">
    <h3 class="mb-1">Test String</h3>
    <p class="mb-2">Leave empty to test empty string</p>
    <div class="input-group mb-3">
      <input 
        type="text" 
        [(ngModel)]="testString"
        placeholder="Enter string to test ({{ alphabet === 'ab' ? 'aabba' : '01101' }})"
        class="form-control"
      />
      <button 
        (click)="testStringInput()" 
        class="btn btn-primary"
      >
        Test
      </button>
    </div>
    <div *ngIf="testResult !== null" class="alert" [ngClass]="testResult ? 'alert-success' : 'alert-danger'">
      <strong *ngIf="testResult">String is in the language</strong>
      <strong *ngIf="!testResult">String is in not the language</strong>
    </div>
  </div>
</div>

 
